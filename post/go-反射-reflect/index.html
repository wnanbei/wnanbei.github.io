<!doctype html><html lang=zh-cn>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="反射是程序在运行期间检查其自身结构的一种方式 。
反射三大法则：
 反射可以将接口类型变量转换为反射类型对象 反射可以将反射类型对象转换为接口类型变量 如果要修改反射类型对象，其值必须是可写的(settable) "><title>Go 反射 reflect</title>
<link rel=canonical href=https://wnanbei.github.io/post/go-%E5%8F%8D%E5%B0%84-reflect/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Go 反射 reflect">
<meta property="og:description" content="反射是程序在运行期间检查其自身结构的一种方式 。
反射三大法则：
 反射可以将接口类型变量转换为反射类型对象 反射可以将反射类型对象转换为接口类型变量 如果要修改反射类型对象，其值必须是可写的(settable) ">
<meta property="og:url" content="https://wnanbei.github.io/post/go-%E5%8F%8D%E5%B0%84-reflect/">
<meta property="og:site_name" content="WNANBEI">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Go"><meta property="article:published_time" content="2020-06-05T00:00:00+00:00"><meta property="article:modified_time" content="2021-11-09T23:34:24+08:00">
<meta name=twitter:title content="Go 反射 reflect">
<meta name=twitter:description content="反射是程序在运行期间检查其自身结构的一种方式 。
反射三大法则：
 反射可以将接口类型变量转换为反射类型对象 反射可以将反射类型对象转换为接口类型变量 如果要修改反射类型对象，其值必须是可写的(settable) ">
<link rel="shortcut icon" href=images/favicon.jpg>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>返回</span>
</a>
</div>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/go%E6%A0%87%E5%87%86%E5%BA%93/>
Go标准库
</a>
</header>
<h2 class=article-title>
<a href=/post/go-%E5%8F%8D%E5%B0%84-reflect/>Go 反射 reflect</a>
</h2>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2020-06-05</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
阅读时长: 6 分钟
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<p>反射是程序在运行期间检查其自身结构的一种方式 。</p>
<p>反射三大法则：</p>
<ul>
<li>反射可以将<code>接口类型变量</code>转换为<code>反射类型对象</code></li>
<li>反射可以将<code>反射类型对象</code>转换为<code>接口类型变量</code></li>
<li>如果要修改<code>反射类型对象</code>，其值必须是<code>可写的(settable)</code></li>
</ul>
<h2 id=type>Type</h2>
<p><code>Type</code> 表示的是对象的具体类型。</p>
<p>从普通类型变量获取反射类型 <code>Type</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>TypeOf</span>(<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>interface</span>{}) <span style=color:#a6e22e>Type</span>
</code></pre></div><p>其他方法：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>ChanOf</span>(<span style=color:#a6e22e>dir</span> <span style=color:#a6e22e>ChanDir</span>, <span style=color:#a6e22e>t</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Type</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>FuncOf</span>(<span style=color:#a6e22e>in</span>, <span style=color:#a6e22e>out</span> []<span style=color:#a6e22e>Type</span>, <span style=color:#a6e22e>variadic</span> <span style=color:#66d9ef>bool</span>) <span style=color:#a6e22e>Type</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>MapOf</span>(<span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>elem</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Type</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>SliceOf</span>(<span style=color:#a6e22e>t</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Type</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>ArrayOf</span>(<span style=color:#a6e22e>count</span> <span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>elem</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Type</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>StructOf</span>(<span style=color:#a6e22e>fields</span> []<span style=color:#a6e22e>StructField</span>) <span style=color:#a6e22e>Type</span>
</code></pre></div><p><code>Type</code> 本身是一个 reflect 库暴露出的接口，定义了许多方法，但根据其本身的具体类型，可以使用的方法并不相同。</p>
<h3 id=方法>方法</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 只返回类型名，不含包名
</span><span style=color:#75715e></span><span style=color:#a6e22e>Name</span>() <span style=color:#66d9ef>string</span>
<span style=color:#75715e>// 返回类型名字，为包名 + Name()
</span><span style=color:#75715e></span><span style=color:#a6e22e>String</span>() <span style=color:#66d9ef>string</span>
<span style=color:#75715e>// 返回导入路径，即 import 路径
</span><span style=color:#75715e></span><span style=color:#a6e22e>PkgPath</span>() <span style=color:#66d9ef>string</span>
<span style=color:#75715e>// 返回 rtype.size 即类型大小，单位是字节数
</span><span style=color:#75715e></span><span style=color:#a6e22e>Size</span>() <span style=color:#66d9ef>uintptr</span>
<span style=color:#75715e>// 返回 rtype.kind，描述一种基础类型
</span><span style=color:#75715e></span><span style=color:#a6e22e>Kind</span>() <span style=color:#a6e22e>Kind</span>
<span style=color:#75715e>// 返回类型的位大小，但不是所有类型都能调这个方法，不能调的会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>Bits</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 检查当前类型能不能做比较运算，主要根据此类型底层有没有绑定 typeAlg 的 equal 方法。
</span><span style=color:#75715e></span><span style=color:#a6e22e>Comparable</span>() <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 变量的内存对齐，返回 rtype.align
</span><span style=color:#75715e></span><span style=color:#a6e22e>Align</span>() <span style=color:#66d9ef>int</span>
</code></pre></div><h3 id=struct>Struct</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 返回 struct 字段数量，不是 struct 会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>NumField</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 返回 struct 类型的第 i 个字段，不是 struct 会 panic，i 越界也会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>Field</span>(<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>StructField</span>
<span style=color:#75715e>// 返回 struct 类型的字段，是嵌套调用，比如 [1, 2] 就是返回当前 struct 的第 1 个 struct 的第 2 个字段，适用于 struct 本身嵌套的类型
</span><span style=color:#75715e></span><span style=color:#a6e22e>FieldByIndex</span>(<span style=color:#a6e22e>index</span> []<span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>StructField</span>
<span style=color:#75715e>// 按名字找 struct 字段，第二个返回值 ok 表示有没有
</span><span style=color:#75715e></span><span style=color:#a6e22e>FieldByName</span>(<span style=color:#a6e22e>name</span> <span style=color:#66d9ef>string</span>) (<span style=color:#a6e22e>StructField</span>, <span style=color:#66d9ef>bool</span>)
<span style=color:#75715e>// 按函数签名找 struct 字段，因为 struct 字段也可能是 func 类型
</span><span style=color:#75715e></span><span style=color:#a6e22e>FieldByNameFunc</span>(<span style=color:#a6e22e>match</span> <span style=color:#66d9ef>func</span>(<span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>bool</span>) (<span style=color:#a6e22e>StructField</span>, <span style=color:#66d9ef>bool</span>)
<span style=color:#75715e>// 根据传入的 i，返回方法实例，表示类型的第 i 个方法
</span><span style=color:#75715e></span><span style=color:#a6e22e>Method</span>(<span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Method</span>
<span style=color:#75715e>// 根据名字返回方法实例，这个比较常用
</span><span style=color:#75715e></span><span style=color:#a6e22e>MethodByName</span>(<span style=color:#66d9ef>string</span>) (<span style=color:#a6e22e>Method</span>, <span style=color:#66d9ef>bool</span>)
<span style=color:#75715e>// 返回类型方法集中可导出的方法的数量
</span><span style=color:#75715e></span><span style=color:#a6e22e>NumMethod</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// struct 字段的内存对齐，返回 rtype.fieldAlign
</span><span style=color:#75715e></span><span style=color:#a6e22e>FieldAlign</span>() <span style=color:#66d9ef>int</span>
</code></pre></div><h3 id=函数>函数</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 返回函数的参数数量，不是 func 会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>NumIn</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 返回函数的返回值数量，不是 func 会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>NumOut</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 返回函数第 i 个参数的类型，不是 func 会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>In</span>(<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Type</span>
<span style=color:#75715e>// 返回函数第 i 个返回值的类型，不是 func 会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>Out</span>(<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Type</span>
<span style=color:#75715e>// 返回函数类型的最后一个参数是不是可变数量的，&#34;...&#34; 就这样的，同样，如果不是函数类型，会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>IsVariadic</span>() <span style=color:#66d9ef>bool</span>
</code></pre></div><h3 id=interface>Interface</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 检查当前类型有没有实现接口 u
</span><span style=color:#75715e></span><span style=color:#a6e22e>Implements</span>(<span style=color:#a6e22e>u</span> <span style=color:#a6e22e>Type</span>) <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 检查当前类型能不能赋值给接口 u
</span><span style=color:#75715e></span><span style=color:#a6e22e>AssignableTo</span>(<span style=color:#a6e22e>u</span> <span style=color:#a6e22e>Type</span>) <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 检查当前类型能不能转换成接口 u 类型
</span><span style=color:#75715e></span><span style=color:#a6e22e>ConvertibleTo</span>(<span style=color:#a6e22e>u</span> <span style=color:#a6e22e>Type</span>) <span style=color:#66d9ef>bool</span>
</code></pre></div><h3 id=基础数据类型>基础数据类型</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 返回 map 的 key 的类型，不是 map 会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>Key</span>() <span style=color:#a6e22e>Type</span>
<span style=color:#75715e>// 返回 array 的长度，不是 array 会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>Len</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 返回 channel 类型的方向，如果不是 channel，会 panic
</span><span style=color:#75715e></span><span style=color:#a6e22e>ChanDir</span>() <span style=color:#a6e22e>ChanDir</span>
<span style=color:#75715e>// 返回所包含元素的类型，只有 Array, Chan, Map, Ptr, Slice 这些才能调，其他类型会 panic。
</span><span style=color:#75715e></span><span style=color:#a6e22e>Elem</span>() <span style=color:#a6e22e>Type</span>
</code></pre></div><h2 id=value>Value</h2>
<p><code>Value</code> 表示的是对象的值。</p>
<p>从普通类型变量获取反射值 <code>Value</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>ValueOf</span>(<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>interface</span>{}) <span style=color:#a6e22e>Value</span>
</code></pre></div><h3 id=创建-value>创建 Value</h3>
<p>以下这些方法可以创建指定类型的 <code>Value</code>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>MakeChan</span>(<span style=color:#a6e22e>typ</span> <span style=color:#a6e22e>Type</span>, <span style=color:#a6e22e>buffer</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>MakeFunc</span>(<span style=color:#a6e22e>typ</span> <span style=color:#a6e22e>Type</span>, <span style=color:#a6e22e>fn</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>args</span> []<span style=color:#a6e22e>Value</span>) (<span style=color:#a6e22e>results</span> []<span style=color:#a6e22e>Value</span>)) <span style=color:#a6e22e>Value</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>MakeMap</span>(<span style=color:#a6e22e>typ</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>MakeMapWithSize</span>(<span style=color:#a6e22e>typ</span> <span style=color:#a6e22e>Type</span>, <span style=color:#a6e22e>n</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>MakeSlice</span>(<span style=color:#a6e22e>typ</span> <span style=color:#a6e22e>Type</span>, <span style=color:#a6e22e>len</span>, <span style=color:#a6e22e>cap</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 创建值并返回指向它的指针
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>New</span>(<span style=color:#a6e22e>typ</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewAt</span>(<span style=color:#a6e22e>typ</span> <span style=color:#a6e22e>Type</span>, <span style=color:#a6e22e>p</span> <span style=color:#a6e22e>unsafe</span>.<span style=color:#a6e22e>Pointer</span>) <span style=color:#a6e22e>Value</span>
</code></pre></div><h3 id=操作-value>操作 Value</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 将值添加到 Slice 中
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>Append</span>(<span style=color:#a6e22e>s</span> <span style=color:#a6e22e>Value</span>, <span style=color:#a6e22e>x</span> <span style=color:#f92672>...</span><span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 将一个 Slice 内的内容添加到 Slice 中
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>AppendSlice</span>(<span style=color:#a6e22e>s</span>, <span style=color:#a6e22e>t</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 解引用，获取指针 v 指向的值
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>Indirect</span>(<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// Select
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>Select</span>(<span style=color:#a6e22e>cases</span> []<span style=color:#a6e22e>SelectCase</span>) (<span style=color:#a6e22e>chosen</span> <span style=color:#66d9ef>int</span>, <span style=color:#a6e22e>recv</span> <span style=color:#a6e22e>Value</span>, <span style=color:#a6e22e>recvOK</span> <span style=color:#66d9ef>bool</span>)
<span style=color:#75715e>// 返回一个类型的零值，不可更改不可寻址
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>Zero</span>(<span style=color:#a6e22e>typ</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Value</span>
</code></pre></div><h2 id=value-方法>Value 方法</h2>
<p><code>Value</code> 是一个定义的结构体，其有许多定义好的方法，根据其原始类型的不同，能使用的方法也不同。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Value</span> <span style=color:#66d9ef>struct</span> {
    <span style=color:#a6e22e>typ</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>rtype</span>           <span style=color:#75715e>// 反射出来此值的类型
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>ptr</span> <span style=color:#a6e22e>unsafe</span>.<span style=color:#a6e22e>Pointer</span>  <span style=color:#75715e>// 数据形式的指针值
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>flag</span>                <span style=color:#75715e>// 保存元数据
</span><span style=color:#75715e></span>}
</code></pre></div><h3 id=获取具体类型值>获取具体类型值</h3>
<p>使用这些方法可以获取到 <code>Value</code> 对应类型的具体的值。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>String</span>() <span style=color:#66d9ef>string</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Int</span>() <span style=color:#66d9ef>int64</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Uint</span>() <span style=color:#66d9ef>uint64</span> 
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Float</span>() <span style=color:#66d9ef>float64</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Bool</span>() <span style=color:#66d9ef>bool</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Slice</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Slice3</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#a6e22e>k</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>  <span style=color:#75715e>// 用 v[i:j:k] 的方式获取切片
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Bytes</span>() []<span style=color:#66d9ef>byte</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Complex</span>() <span style=color:#66d9ef>complex128</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Interface</span>() (<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>interface</span>{})
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Pointer</span>() <span style=color:#66d9ef>uintptr</span>  <span style=color:#75715e>// 获取指针
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>UnsafeAddr</span>() <span style=color:#66d9ef>uintptr</span>  <span style=color:#75715e>// 获取 unsafe 包中的指针
</span></code></pre></div><h3 id=通用方法>通用方法</h3>
<p>这些通用方法基本上是所有类型都可以使用的方法。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 获取 Value 的 Type
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Type</span>() <span style=color:#a6e22e>Type</span>  
<span style=color:#75715e>// 获取 Value 的 Kind
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Kind</span>() <span style=color:#a6e22e>Kind</span>
<span style=color:#75715e>// 转换 v 的类型，返回转换以后的值
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Convert</span>(<span style=color:#a6e22e>t</span> <span style=color:#a6e22e>Type</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 判断 v 是否合法，如果返回 false，那么除了 String() 以外的其他方法调用都会 panic，事前检查是必要的
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>IsValid</span>() <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 判断 Value 是否为零值
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>IsZero</span>() <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 获取表示 v 的地址的指针值
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Addr</span>() <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 判断 v 是否是可寻址的
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>CanAddr</span>() <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 判断 v 的值是否可以被更改
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>CanSet</span>() <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 这几个方法判断值是否超出了它的类型能表示的范围
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>OverflowInt</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>int64</span>) <span style=color:#66d9ef>bool</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>OverflowFloat</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>float64</span>) <span style=color:#66d9ef>bool</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>OverflowUint</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>uint64</span>) <span style=color:#66d9ef>bool</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>OverflowComplex</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>complex128</span>) <span style=color:#66d9ef>bool</span>
</code></pre></div><h3 id=更改值>更改值</h3>
<p>以下这些方法可以更改 <code>Value</code> 的值，但必须符合底层类型。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Set</span>(<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>Value</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetBool</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>bool</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetBytes</span>(<span style=color:#a6e22e>x</span> []<span style=color:#66d9ef>byte</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetCap</span>(<span style=color:#a6e22e>n</span> <span style=color:#66d9ef>int</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetComplex</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>complex128</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetFloat</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>float64</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetInt</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>int64</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetLen</span>(<span style=color:#a6e22e>n</span> <span style=color:#66d9ef>int</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetMapIndex</span>(<span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>elem</span> <span style=color:#a6e22e>Value</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetPointer</span>(<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>unsafe</span>.<span style=color:#a6e22e>Pointer</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetString</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>string</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>SetUint</span>(<span style=color:#a6e22e>x</span> <span style=color:#66d9ef>uint64</span>)
</code></pre></div><h3 id=struct-1>Struct</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 获取 struct 字段数量
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>NumField</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 获取 struct 方法数量
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>NumMethod</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 获取 sturct 第 i 个字段，主要用于遍历
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Field</span>(<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 获取 struct 名为 name 的字段
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>FieldByName</span>(<span style=color:#a6e22e>name</span> <span style=color:#66d9ef>string</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 获取 Struct 内嵌套的方法，[]int 为嵌套的路径
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>FieldByIndex</span>(<span style=color:#a6e22e>index</span> []<span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 根据函数签名获取 struct 字段中的函数
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>FieldByNameFunc</span>(<span style=color:#a6e22e>match</span> <span style=color:#66d9ef>func</span>(<span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>bool</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 获取 struct 第 i 个方法
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Method</span>(<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 获取 struct 名为 name 的方法
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>MethodByName</span>(<span style=color:#a6e22e>name</span> <span style=color:#66d9ef>string</span>) <span style=color:#a6e22e>Value</span>
</code></pre></div><h3 id=混合类型方法>混合类型方法</h3>
<p>这些混合类型方式是限定为一部分类型可用的。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 判断 v 是不是 nil，类型为：Chan, Func, Interface, Map, Pointer, Slice
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>IsNil</span>() <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 获取 v 的 len 值，类型为：Array, Chan, Map, Slice, String.
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Len</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 返回 v 的 cap 值，类型为：Array, Slice, Chan
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Cap</span>() <span style=color:#66d9ef>int</span>
<span style=color:#75715e>// 返回 v 的第 i 个元素，类型为：Array, Slice, String
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Index</span>(<span style=color:#a6e22e>i</span> <span style=color:#66d9ef>int</span>) <span style=color:#a6e22e>Value</span>
</code></pre></div><h3 id=channel>Channel</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// Recv 和 Send 在没有完成操作时会阻塞
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Recv</span>() (<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>Value</span>, <span style=color:#a6e22e>ok</span> <span style=color:#66d9ef>bool</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>Value</span>)
<span style=color:#75715e>// TryRecv 和 TrySend 不会阻塞，如果操作没有完成，会返回零值和 false
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>TryRecv</span>() (<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>Value</span>, <span style=color:#a6e22e>ok</span> <span style=color:#66d9ef>bool</span>)
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>TrySend</span>(<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>Value</span>) <span style=color:#66d9ef>bool</span>
<span style=color:#75715e>// 关闭通道
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Close</span>()
</code></pre></div><h3 id=7-map>7. Map</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 用 key 获取 map 的值
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>MapIndex</span>(<span style=color:#a6e22e>key</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 获取 map 所有的key
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>MapKeys</span>() []<span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 可以用来遍历 map 的方法
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>MapRange</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>MapIter</span>
</code></pre></div><p>遍历例子：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#a6e22e>iter</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>reflect</span>.<span style=color:#a6e22e>ValueOf</span>(<span style=color:#a6e22e>m</span>).<span style=color:#a6e22e>MapRange</span>()
<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>iter</span>.<span style=color:#a6e22e>Next</span>() {
	<span style=color:#a6e22e>k</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>iter</span>.<span style=color:#a6e22e>Key</span>()
	<span style=color:#a6e22e>v</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>iter</span>.<span style=color:#a6e22e>Value</span>()
	<span style=color:#f92672>...</span>
}
</code></pre></div><h3 id=func>Func</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 调用函数 v，并将参数作为 Value 切片传入
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Call</span>(<span style=color:#a6e22e>in</span> []<span style=color:#a6e22e>Value</span>) []<span style=color:#a6e22e>Value</span>
<span style=color:#75715e>// 调用函数 v，并将参数作为 Value 切片传入，CallSlice 会将 in 中最后一个参数作为可变参数传入
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>CallSlice</span>(<span style=color:#a6e22e>in</span> []<span style=color:#a6e22e>Value</span>) []<span style=color:#a6e22e>Value</span>
</code></pre></div><h3 id=interface-1>Interface</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#75715e>// 返回 v 的接口值或者指针
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>Elem</span>() <span style=color:#a6e22e>Value</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>CanInterface</span>() <span style=color:#66d9ef>bool</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>v</span> <span style=color:#a6e22e>Value</span>) <span style=color:#a6e22e>InterfaceData</span>() [<span style=color:#ae81ff>2</span>]<span style=color:#66d9ef>uintptr</span>
</code></pre></div><h2 id=kind>Kind</h2>
<p><code>Kind</code> 表示的是对象的原生底层类型。有以下这些类型：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>const</span> (
    <span style=color:#a6e22e>Invalid</span> <span style=color:#a6e22e>Kind</span> = <span style=color:#66d9ef>iota</span>
    <span style=color:#a6e22e>Bool</span>
    <span style=color:#a6e22e>Int</span>
    <span style=color:#a6e22e>Int8</span>
    <span style=color:#a6e22e>Int16</span>
    <span style=color:#a6e22e>Int32</span>
    <span style=color:#a6e22e>Int64</span>
    <span style=color:#a6e22e>Uint</span>
    <span style=color:#a6e22e>Uint8</span>
    <span style=color:#a6e22e>Uint16</span>
    <span style=color:#a6e22e>Uint32</span>
    <span style=color:#a6e22e>Uint64</span>
    <span style=color:#a6e22e>Uintptr</span>
    <span style=color:#a6e22e>Float32</span>
    <span style=color:#a6e22e>Float64</span>
    <span style=color:#a6e22e>Complex64</span>
    <span style=color:#a6e22e>Complex128</span>
    <span style=color:#a6e22e>Array</span>
    <span style=color:#a6e22e>Chan</span>
    <span style=color:#a6e22e>Func</span>
    <span style=color:#a6e22e>Interface</span>
    <span style=color:#a6e22e>Map</span>
    <span style=color:#a6e22e>Ptr</span>
    <span style=color:#a6e22e>Slice</span>
    <span style=color:#a6e22e>String</span>
    <span style=color:#a6e22e>Struct</span>
    <span style=color:#a6e22e>UnsafePointer</span>
)
</code></pre></div><p>还有一个 <code>func (k Kind) String() string</code> 方法可以返回 Kind 的名称。</p>
<h2 id=structfield>StructField</h2>
<p>此结构体用来表示 Struct 的字段：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>StructField</span> <span style=color:#66d9ef>struct</span> {
    <span style=color:#a6e22e>Name</span>      <span style=color:#66d9ef>string</span>    <span style=color:#75715e>// 字段名
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>PkgPath</span>   <span style=color:#66d9ef>string</span>    <span style=color:#75715e>// PkgPath 是未导出字段的程序包路径，可导出字段此值为空
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>Type</span>      <span style=color:#a6e22e>Type</span>      <span style=color:#75715e>// 字段类型
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>Tag</span>       <span style=color:#a6e22e>StructTag</span> <span style=color:#75715e>// 字段的 Tag
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>Offset</span>    <span style=color:#66d9ef>uintptr</span>   <span style=color:#75715e>// 在 struct 中的偏移量，单位 bytes
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>Index</span>     []<span style=color:#66d9ef>int</span>     <span style=color:#75715e>// 字段在 struct 中的数字索引
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>Anonymous</span> <span style=color:#66d9ef>bool</span>      <span style=color:#75715e>// 是否是一个嵌入式字段
</span><span style=color:#75715e></span>}
</code></pre></div><h2 id=structtag>StructTag</h2>
<p>此类型用来表示 Struct 字段的 Tag 字符串，其有两个方法可以获取 Tag 中设定的值。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>tag</span> <span style=color:#a6e22e>StructTag</span>) <span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>key</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>string</span>
<span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>tag</span> <span style=color:#a6e22e>StructTag</span>) <span style=color:#a6e22e>Lookup</span>(<span style=color:#a6e22e>key</span> <span style=color:#66d9ef>string</span>) (<span style=color:#a6e22e>value</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>ok</span> <span style=color:#66d9ef>bool</span>)
</code></pre></div><ul>
<li>
<p><code>Get</code> 在没有这个字段和字段为空字符时，都会返回空字符。</p>
</li>
<li>
<p>所以如果需要检查是否设置了这个 Tag，需要使用 <code>Lookup</code>。例子：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>S</span> <span style=color:#66d9ef>struct</span> {
    <span style=color:#a6e22e>F0</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`alias:&#34;field_0&#34;`</span>
    <span style=color:#a6e22e>F1</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`alias:&#34;&#34;`</span>
    <span style=color:#a6e22e>F2</span> <span style=color:#66d9ef>string</span>
}

<span style=color:#a6e22e>s</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>S</span>{}
<span style=color:#a6e22e>st</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>reflect</span>.<span style=color:#a6e22e>TypeOf</span>(<span style=color:#a6e22e>s</span>)
<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>:=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> &lt; <span style=color:#a6e22e>st</span>.<span style=color:#a6e22e>NumField</span>(); <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span> {
    <span style=color:#a6e22e>field</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>st</span>.<span style=color:#a6e22e>Field</span>(<span style=color:#a6e22e>i</span>)
    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>alias</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>field</span>.<span style=color:#a6e22e>Tag</span>.<span style=color:#a6e22e>Lookup</span>(<span style=color:#e6db74>&#34;alias&#34;</span>); <span style=color:#a6e22e>ok</span> {
        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>alias</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
            <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;(blank)&#34;</span>)
        } <span style=color:#66d9ef>else</span> {
            <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>alias</span>)
        }
    } <span style=color:#66d9ef>else</span> {
        <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;(not specified)&#34;</span>)
    }
}
</code></pre></div></li>
</ul>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/go/>Go</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under MIT License</span>
</section>
<section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>
最后更新于 2021-11-09 23:34:24
</span>
</section></footer>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>相关文章</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article>
<a href=/post/go-%E4%BB%A4%E7%89%8C%E6%A1%B6%E9%99%90%E6%B5%81%E5%99%A8-golang.org/x/time/rate/>
<div class=article-details>
<h2 class=article-title>Go 令牌桶限流器 golang.org/x/time/rate</h2>
</div>
</a>
</article>
<article>
<a href=/post/go-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86-strings/>
<div class=article-details>
<h2 class=article-title>Go 字符串处理 strings</h2>
</div>
</a>
</article>
<article>
<a href=/post/go-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2-strconv/>
<div class=article-details>
<h2 class=article-title>Go 字符串类型转换 strconv</h2>
</div>
</a>
</article>
<article>
<a href=/post/go-%E6%A0%87%E5%87%86%E5%BA%93-io/>
<div class=article-details>
<h2 class=article-title>Go 标准库 io</h2>
</div>
</a>
</article>
<article>
<a href=/post/go-%E6%A0%87%E5%87%86%E5%BA%93-ioutil/>
<div class=article-details>
<h2 class=article-title>Go 标准库 ioutil</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<footer class=site-footer>
<section class=copyright>
&copy;
2021 WNANBEI
</section>
<section class=powerby>
The world has kissed my soul with its pain, asking for its return in songs. <br>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">目录</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#type>Type</a>
<ol>
<li><a href=#方法>方法</a></li>
<li><a href=#struct>Struct</a></li>
<li><a href=#函数>函数</a></li>
<li><a href=#interface>Interface</a></li>
<li><a href=#基础数据类型>基础数据类型</a></li>
</ol>
</li>
<li><a href=#value>Value</a>
<ol>
<li><a href=#创建-value>创建 Value</a></li>
<li><a href=#操作-value>操作 Value</a></li>
</ol>
</li>
<li><a href=#value-方法>Value 方法</a>
<ol>
<li><a href=#获取具体类型值>获取具体类型值</a></li>
<li><a href=#通用方法>通用方法</a></li>
<li><a href=#更改值>更改值</a></li>
<li><a href=#struct-1>Struct</a></li>
<li><a href=#混合类型方法>混合类型方法</a></li>
<li><a href=#channel>Channel</a></li>
<li><a href=#7-map>7. Map</a></li>
<li><a href=#func>Func</a></li>
<li><a href=#interface-1>Interface</a></li>
</ol>
</li>
<li><a href=#kind>Kind</a></li>
<li><a href=#structfield>StructField</a></li>
<li><a href=#structtag>StructTag</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>